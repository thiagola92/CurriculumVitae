<canvas id="canvasBall" width="300" height="300" style="border: 1px solid black">
</canvas>

<script type="text/javascript">
  let canvas = document.getElementById("canvasBall");
  let context = canvas.getContext("2d");
  let audio = new Audio("puft.mp3");

  let radius = 170;
  let angleFraction = Math.PI/180;
  let angle = 90;
  let dislocate_x = 0;;
  let dislocate_y = 255;

  let x;
  let y;

  let touchName = false;
  let stop = true;
  let audioReady = false;

  audio.addEventListener("canplay", () => {
    audioReady = true;
  });

  canvas.addEventListener("click", () => {
    if(audioReady == true && touchName == false) {
      stop = false
    }
  });

  function calculateXY() {
    x = dislocate_x + radius * Math.cos(angle*angleFraction); // 75 and 255
    y = dislocate_y - radius * Math.sin(angle*angleFraction);
  }

  function drawBall() {
    context.beginPath();
    context.fillStyle = "#ff1463";
    context.strokeStyle = "#ff1463";
    context.arc(x, y, 25, 0, 2*Math.PI)
    context.stroke();
    context.fill();
  }

  function writeThiago() {
    context.font = "30px Arial";
    context.fillText("TTTTTTThiago", 100, 300);
  }

  function fakeMovement() {
    angle = angle - 1; // diminuindo o angulo

    if(angle == 3 && touchName == false) {
      dislocate_x = 340;
      angle = 180 - angle;
      touchName = true;
      audio.volume = 0.1;
      audio.play();
    }

    if(angle == 90+45 && touchName == true) {
      stop = true;

      context.font = "30px Arial";
      context.fillText(":^)", 220, 100);
    }
  }

  function update() {
    if(stop == true) {
      return;
    }
    context.clearRect(0, 0, canvas.width, canvas.height);
    drawBall();
    writeThiago();
    fakeMovement();
    calculateXY();
  }

  setInterval(update, 10)
  update();

</script>
